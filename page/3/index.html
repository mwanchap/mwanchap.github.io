<!DOCTYPE html>
<html lang="en-us">
    
  <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.68.3" />

    

<title>Matt Wanchap</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Matt Wanchap"/>
<meta name="twitter:description" content=""/>

<meta property="og:title" content="Matt Wanchap" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://wanchap.com/" />
<meta property="og:updated_time" content="2019-12-31T08:38:31+10:00" />


    






<link rel="stylesheet" href="/scss/hyde-hyde.9181f25ed2263aeb878ec6f8a84f10c4ebb16150000fca8767308880bdde5ca0.css"> 


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" media="print"> 



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <link rel="alternate" type="application/rss+xml" href="https://wanchap.com/index.xml" title="Matt Wanchap" />

    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://wanchap.com/">Matt Wanchap</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://wanchap.com/matt.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Matt Wanchap</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Projects</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/MattWanchap" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://facebook.com/mwanchap" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/mwanchap" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/mwanchap" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/2939759" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
  <div class="post-list">
    
    
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/get-the-maximum-length-of-every-field-in-a-csv-excel-etc/" >Get the maximum length of every field in a CSV, Excel etc</a>
        </span>
        <span class="item__date">
          Jun 30, 2019
        </span>
        <span >
        
        While setting up tables in our data warehouse for use with some external APIs, it was getting a little tedious to figure out the max length of some long fields to get the write size for CREATE TABLE statements, so I wrote this little script to calculate it for me. Yeah, it&rsquo;s kinda messy, so sue me (or don&rsquo;t). You can swap out the import-csv part to also import from Excel or whatever else
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/get-the-maximum-length-of-every-field-in-a-csv-excel-etc/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/handling-double-quoted-csvs-in-azure-data-factory-pipelines/" >Handling double-quoted CSVs in Azure Data Factory Pipelines</a>
        </span>
        <span class="item__date">
          Jun 12, 2019
        </span>
        <span >
        
        Azure Data Factory by default uses a backslash as the escape character for CSVs, but we ran into an issue with this today processing one of the CSV files from data.gov.au. As with most CSVs they use quotes around values as normal and with double-quotes for empty values, but they also use double-quotes to escape quotes within non-empty values. This probably sounds confusing, so here&rsquo;s an example:
&quot;column 1&rdquo;,&ldquo;column 2&rdquo;,&quot;&ldquo;,&ldquo;column 4 value is &quot;&ldquo;sort of&quot;&ldquo; like this&quot;
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/handling-double-quoted-csvs-in-azure-data-factory-pipelines/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/handy-soql-query-snippets/" >Handy SOQL query snippets</a>
        </span>
        <span class="item__date">
          Jun 04, 2019
        </span>
        <span >
        
        To count how many people logged in for the last time each year, for only inactive users:
select calendar_year(lastlogindate) LoginYear,count(id) Totalfrom userwhere isactive = falseand lastlogindate &lt;&gt; nullgroup by calendar_year(lastlogindate)order by count(id) desc
        
        </span>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/formats-for-dealing-with-dates-and-datetimes-in-salesforce/" >Formats for dealing with dates and datetimes in Salesforce</a>
        </span>
        <span class="item__date">
          Apr 23, 2019
        </span>
        <span >
        
        The correct way to format dates (not datetimes!) for bulk importing CSVs into Salesforce looks like year-month-day, so today would look like 2019-06-17. These default to the timezone set for the user importing them, so there&rsquo;s no need to convert to UTC. Set this in Excel by
Select the column/s containing datesRight click on them and select &ldquo;Format Cells&rdquo; from the menuSelect the format &ldquo;2012-03-14&quot;Save as CSV (not the UTF-8 type of CSV)
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/formats-for-dealing-with-dates-and-datetimes-in-salesforce/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/diy-salesforce-partial-copy-sandbox-using-sandboxberry/" >DIY Salesforce partial copy sandbox using SandboxBerry</a>
        </span>
        <span class="item__date">
          Apr 17, 2019
        </span>
        <span >
        
        Salesforce partial copy sandboxes are expensive, but it&rsquo;s possible to approximate one if you&rsquo;re willing to spend a little time moving the data around yourself with a fantastic little tool called SandboxBerry, which you can get from here. Big thanks to Ian Finch for all his work on it!
Below are the steps I had to go through to get all my data imported. Please let me know if you have any suggestions that could make this easier or more effective!
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/diy-salesforce-partial-copy-sandbox-using-sandboxberry/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/useful-azure-ad-powershell-snippets/" >Useful Azure AD Powershell snippets</a>
        </span>
        <span class="item__date">
          Apr 14, 2019
        </span>
        <span >
        
        I&rsquo;ve been doing a lot of Azure AD stuff lately, so here are some powershell snippets that have been coming in handy.
I always forget to Connect-AzureAD first, so don&rsquo;t do that
Get extension properties of a user (e.g. created date)
Get-AzureADUser -SearchString &lsquo;username or email addy&rsquo; | select -ExpandProperty ExtensionProperty
Get guest users that are not members of a specified group
$allGuests = Get-AzureADUser -Filter &ldquo;usertype eq &lsquo;guest&rsquo;&rdquo; -All $true
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/useful-azure-ad-powershell-snippets/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/get-details-and-creators-of-all-salesforce-reports-that-reference-a-specified-field/" >Get details and creators of all Salesforce reports that reference a specified field</a>
        </span>
        <span class="item__date">
          Apr 09, 2019
        </span>
        <span >
        
        If you&rsquo;re ever modifying a Salesforce field and you want to contact everyone who has created reports using the field, here&rsquo;s how you do that using Powershell and the Force.com CLI (which you can also install via chocolatey):
set-location C:\wherever
force export
$reportFiles = get-childitem -Path .\src\reports\ -Recurse | sls &ldquo;field_to_search_for&quot;
# I&rsquo;ve included some extra fields here, they might come in useful
$reportData = force query &ndash;format=json &ldquo;select id, createdby.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/get-details-and-creators-of-all-salesforce-reports-that-reference-a-specified-field/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/salesforce-bulk-data-load-job-fails-with-message-invalidbatch-field-name-not-found-id/" >Salesforce bulk data load job fails with message &#39;InvalidBatch : Field name not found: Id&#39;</a>
        </span>
        <span class="item__date">
          Apr 08, 2019
        </span>
        <span >
        
        After creating a bulk / batch job, I&rsquo;ll sometimes see that it failed before even starting (failed batches:1, but with 0 records failed), with the following error:
InvalidBatch : Field name not found: ﻿Id
Annoyingly, this is caused by the inability of the Salesforce bulk import process to handle anything but ASCII. Try saving your CSV again, making sure it&rsquo;s in ASCII (called &ldquo;CSV (Comma delimited)&rdquo; in Excel) and not using UTF-8 or some other encoding.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/salesforce-bulk-data-load-job-fails-with-message-invalidbatch-field-name-not-found-id/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/azure-ad-error-idx10311-requirenonce-is-true-but-validationcontext.nonce-is-null/" >Azure AD error - &#39;IDX10311: RequireNonce is true but validationContext.Nonce is null&#39;</a>
        </span>
        <span class="item__date">
          Mar 13, 2019
        </span>
        <span >
        
        I&rsquo;ve experienced this one enough times now that I&rsquo;d like to preserve the solution/s for future occurrences. The exact message is:
IDX10311: RequireNonce is &lsquo;true&rsquo; (default) but validationContext.Nonce is null. A nonce cannot be validated. If you don&rsquo;t need to check the nonce, set OpenIdConnectProtocolValidator.RequireNonce to &lsquo;false&rsquo;.An easy way to reproduce this one is to hit the &ldquo;back&rdquo; button after having signed in to an ASP.NET web app that auths with Azure AD using the OWIN library.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/azure-ad-error-idx10311-requirenonce-is-true-but-validationcontext.nonce-is-null/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/testing-sendgrid-smtp-without-sending-emails-using-sandbox-mode/" >Testing Sendgrid SMTP without sending emails using sandbox mode</a>
        </span>
        <span class="item__date">
          Mar 03, 2019
        </span>
        <span >
        
        Here&rsquo;s how to test out a Sendgrid integration using SMTP without actually sending emails. Obviously make sure you have Sendgrid SMTP set up in your config first, and then just add the X-SMTPAPI header (docs link) with some JSON like the below.
MailMessage msg = new MailMessage();
var json = @&quot;{
&ldquo;&ldquo;mail_settings&rdquo;&quot;: {
&ldquo;&ldquo;sandbox_mode&rdquo;&quot;: {
&ldquo;&ldquo;enable&rdquo;&quot;: true
}
}
}&quot;;
msg.Headers.Add(&ldquo;X-SMTPAPI&rdquo;, json);
// all the usual email stuff
SmtpClient smtpclient = new SmtpClient();
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/testing-sendgrid-smtp-without-sending-emails-using-sandbox-mode/">➦</a>
        
        </div>
        
     
  </div>
  

<ul class="pagination">
    
    <li class="page-item">
        <a href="/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/page/2/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/4/">4</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/9/">9</a></li>
    
    
    <li class="page-item">
    <a href="/page/4/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/page/9/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>


        </div>
        
  
  <script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    </body>
</html>
