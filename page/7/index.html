<!DOCTYPE html>
<html lang="en-us">
    
  <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.67.0" />

    

<title>Matt Wanchap</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Matt Wanchap"/>
<meta name="twitter:description" content=""/>

<meta property="og:title" content="Matt Wanchap" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://wanchap.com/" />
<meta property="og:updated_time" content="2019-12-31T08:38:31+10:00" />


    






<link rel="stylesheet" href="/scss/hyde-hyde.9181f25ed2263aeb878ec6f8a84f10c4ebb16150000fca8767308880bdde5ca0.css"> 


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" media="print"> 



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    <link rel="alternate" type="application/rss+xml" href="https://wanchap.com/index.xml" title="Matt Wanchap" />

    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://wanchap.com/">Matt Wanchap</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://wanchap.com/matt.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Matt Wanchap</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Projects</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/MattWanchap" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://facebook.com/mwanchap" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/mwanchap" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/mwanchap" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/2939759" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
  <div class="post-list">
    
    
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/iis-preventing-url-access-to-a-specific-directory/" >IIS - Preventing URL Access to a Specific Directory</a>
        </span>
        <span class="item__date">
          Oct 09, 2014
        </span>
        <span >
        
        Yesterday I was asked to made a web page which provided the ability to download files, which weren&rsquo;t served directly (by passing the file URL to the client) but were sent by reading the file on the server and sending the output. However, I realised that the files could still be accessed by an unauthenticated user by typing in the file&rsquo;s direct URL. Most solutions to this that I found required remote access to the server (which I don&rsquo;t have) or adding URL rewrite rules (the URL rewrite module wasn&rsquo;t installed).
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/iis-preventing-url-access-to-a-specific-directory/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/preventing-the-dynamics-crm-outlook-add-in-from-creating-contacts-forever/" >Preventing the Dynamics CRM Outlook add-in from creating contacts, forever</a>
        </span>
        <span class="item__date">
          Sep 25, 2014
        </span>
        <span >
        
        It&rsquo;s an ongoing issue here wherein a misconfigured / misbehaving Outlook client sometimes creates duplicate or redundant contacts in our CRM, and I&rsquo;ve seen many blog posts and forum threads discussing the various ways of getting around it. Unfortunately they all require user-specific configuration, whereas I wanted to banish the problem across the board once-and-for-all. Completely by accident I came across a solution, which in retrospect is extremely obvious and I&rsquo;m rather embarrassed that I didn&rsquo;t figure it out sooner!
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/preventing-the-dynamics-crm-outlook-add-in-from-creating-contacts-forever/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/jquery-ajax-error-logging-on-the-server-with-log4net/" >jQuery ajax error logging on the server with log4net</a>
        </span>
        <span class="item__date">
          Sep 17, 2014
        </span>
        <span >
        
        This post is based on Toby Gundry&rsquo;s post on the same technique, but adapted for logging jQuery ajax errors (although I added a few extra things too).
In your Javascript:
$(document).on({
ajaxError: function (event, jqXHR, ajaxSettings) {
var err = &ldquo;Location: &quot; + document.location.href + &ldquo;; &ldquo;;
if (jqXHR)
{
err += &ldquo;Status: &quot; + jqXHR.status + &ldquo;; &ldquo;;
err += &ldquo;Text: &quot; + jqXHR.statusText + &ldquo;; &ldquo;;
}
if (jqXHR.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/jquery-ajax-error-logging-on-the-server-with-log4net/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/dynamics-crm-error-publishing-entity-role-does-not-exist/" >Dynamics CRM - error publishing entity, role does not exist</a>
        </span>
        <span class="item__date">
          Aug 05, 2014
        </span>
        <span >
        
        This morning I was trying to add a new option to an option set field for a custom entity I had made earlier, however an error dialog popped up which said &ldquo;The requested record is unavailable or you have insufficient permission to view the record&rdquo;, even though I&rsquo;m in a System Administrator role. Upon downloading the exception details and examining them, the actual error was this:
role With Id = dba45c71-05e2-e311-9210-0050568f0001 Does Not Exist
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/dynamics-crm-error-publishing-entity-role-does-not-exist/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/t-sql-easy-way-to-check-for-existence-of-a-temp-table/" >T-SQL: Easy way to check for existence of a temp table</a>
        </span>
        <span class="item__date">
          Jul 30, 2014
        </span>
        <span >
        
        Normally I&rsquo;d do something like selecting from sysobjects to find if a temp table exists, but I found this little gem to drop a global temp table at the start of a query (in case it wasn&rsquo;t cleaned up in the previous execution):
IF(object_id(&lsquo;tempdb..##tmpTable&rsquo;) IS NOT NULL)
DROP TABLE ##tmpTable
GO
I&rsquo;m sure you can come up with a better way to do this rather than using a global temp table, but a local one wasn&rsquo;t going to work in this context since I was using a combination of EXEC and OpenQuery to select from Active Directory, and regular local temp tables seem to disappear upon leaving EXEC, perhaps due to the connection changing or something?
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/t-sql-easy-way-to-check-for-existence-of-a-temp-table/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/iis-and-asp.net-404-error-handlers-dont-play-nicely-together/" >IIS and ASP.NET 404 error handlers don&#39;t play nicely together</a>
        </span>
        <span class="item__date">
          Jul 24, 2014
        </span>
        <span >
        
        While trying to setup both ASP.NET as well as IIS error-handling, I noticed that IIS wasn&rsquo;t dealing with certain 404 errors in which the file extension was wrong. For example, I could request ThisFileDoesntExist.aspx and that would redirect to NotFound.aspx just fine, but WrongExtension.aspz would kick the user out to the ugly default IIS 404 error page.
So I did a bit of investigation and found this post, which pointed out that, in your web.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/iis-and-asp.net-404-error-handlers-dont-play-nicely-together/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/visual-studio-find-was-stopped-in-progress/" >Visual Studio - &#39;Find was stopped in progress&#39;</a>
        </span>
        <span class="item__date">
          May 29, 2014
        </span>
        <span >
        
        Sometimes you&rsquo;ll do a Find for &ldquo;Entire Solution&rdquo; (Ctrl + Shift + F is a handy shortcut) and instead of finding anything, the &ldquo;Find Results&rdquo; window will immediately display &ldquo;Find was stopped in progress&rdquo; with zero results. I usually deal with it by restarting Visual Studio or my computer, but this time I decided to actually look into it. Turns out it was a lot more common than I thought and is apparently a Windows bug, not Visual Studio, and goes way back to 2004.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/visual-studio-find-was-stopped-in-progress/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/the-json-deserialisation-drinking-game/" >The JSON deserialisation drinking game</a>
        </span>
        <span class="item__date">
          May 27, 2014
        </span>
        <span >
        
        Take a drink every time you see this pattern:
$.ajax({
data: &ldquo;{things:stuff}&quot;,
dataType: &ldquo;json&rdquo;,
 //other properties omitted
success: function (result) {
var myObject = eval( &ldquo;(&rdquo; + result.d + &ldquo;)&quot; ); //noooooooooooooooo
}
});
Take a drink when someone seriously brings up the catchphrase &ldquo;eval is evil&rdquo; or a variant of it.
Finish all of the drinks if you sincerely think that nobody would ever get malicious code into your database/application that will be happily executed when eval evaluates it and send your client to their phishing duplicate of your login page where they harvest user credentials before redirecting them right back to your application so nobody ever realises what just happened.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/the-json-deserialisation-drinking-game/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/using-jquery-validation-plugin-with-fields-in-a-jquery-ui-.dialog/" >Using jQuery validation plugin with fields in a jQuery UI .dialog()</a>
        </span>
        <span class="item__date">
          May 21, 2014
        </span>
        <span >
        
        One issue I ran into while using the jQuery UI library along with the jQuery validation plugin in an ASP.NET page is that when the dialog is created, it&rsquo;s moved outside of the page&rsquo;s main form. jQuery validation requires all fields to be validated to be inside a form, so fields in the dialog won&rsquo;t validate, plus if you need to have server-side controls inside of that dialog, there&rsquo;s not a lot you can do to move the dialog or the form.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/using-jquery-validation-plugin-with-fields-in-a-jquery-ui-.dialog/">➦</a>
        
        </div>
        
     
      
        
      
      <div class="post-list__item">
        <span class="item__title--big">
          <a href="/posts/dont-use-eval-to-parse-json-data/" >Don&#39;t use eval to parse JSON data</a>
        </span>
        <span class="item__date">
          May 20, 2014
        </span>
        <span >
        
        Today I read about an interesting security vulnerability in Javascript&rsquo;s eval() function that I wasn&rsquo;t aware of previously (which I was naively using to parse JSON data). Open a developer console and try this:
eval(&ldquo;alert(&lsquo;pwned&rsquo;)&quot;)
The code is executed! This could perhaps be used to return malformed instructions instead of JSON and do something malicious to the client. However, try this:
JSON.parse(&ldquo;alert(&lsquo;not pwned&rsquo;)&quot;)
Notice that it just throws a parsing error, but of course for actual JSON it still produces the correct object.
        
        </span>
        
          ... <a class="read-more-symbol" href="/posts/dont-use-eval-to-parse-json-data/">➦</a>
        
        </div>
        
     
  </div>
  

<ul class="pagination">
    
    <li class="page-item">
        <a href="/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li class="page-item">
    <a href="/page/6/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item disabled"><span aria-hidden="true">&nbsp;&hellip;&nbsp;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/6/">6</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item active"><a class="page-link" href="/page/7/">7</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="page-item"><a class="page-link" href="/page/8/">8</a></li>
    
    
    <li class="page-item">
    <a href="/page/8/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li class="page-item">
        <a href="/page/8/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>


        </div>
        
  
  <script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    </body>
</html>
